Code from https://github.com/golsun/DialogRPT
