services:
  agent:
    build: {context: ./, dockerfile: dockerfile_agent}
    container_name: agent
    depends_on: [aiml, mongo]
    ports: ['28888:8888']
    tty: true
    volumes: ['.:/dp-agent']
  aiml:
    build:
      args: {skill_endpoint: aiml, skillconfig: skills/aiml/aiml_skill.json, skillhost: 0.0.0.0,
        skillport: 2080}
      context: ./
      dockerfile: dp/dockerfile_skill_cpu
    container_name: aiml
    environment: [CUDA_VISIBLE_DEVICES=""]
    ports: ['2080:2080']
    tty: true
    volumes: ['.:/dp-agent', '${EXTERNAL_FOLDER}/dp_logs:/logs', '${EXTERNAL_FOLDER}/.deeppavlov:/root/.deeppavlov']
  mongo:
    command: mongod
    image: mongo:3.2.0
    ports: ['27017:27017']
    volumes: ['/var/run/docker.sock:/var/run/docker.sock']
version: '3'
